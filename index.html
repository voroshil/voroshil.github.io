<!DOCTYPE html>
<html lang="ru">
<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf8">
  <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="main.css">
</head>
<body>
<a href="https://pomber.github.io/covid19/timeseries.json">timeseries.json</a>

    <h4>Данные JHU [<span id="latestDate"></span>]</h4>

<ul class="nav nav-tabs">
  <li class="nav-item">
    <a class="nav-link active" id="latest-tab" data-toggle="tab" href="#latest" role="tab" aria-controls="latest" aria-selected="true">Последние</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="confirmed-history-tab" data-toggle="tab" href="#confirmed-history" role="tab" aria-controls="confirmed-history" aria-selected="false">Зараженные</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="recovered-history-tab" data-toggle="tab" href="#recovered-history" role="tab" aria-controls="recovered-history" aria-selected="false">Вылечившиеся</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="death-history-tab" data-toggle="tab" href="#death-history" role="tab" aria-controls="death-history" aria-selected="false">Смерти</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="active-history-tab" data-toggle="tab" href="#active-history" role="tab" aria-controls="active-history" aria-selected="false">Болеющие</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="fatality-history-tab" data-toggle="tab" href="#fatality-history" role="tab" aria-controls="fatality-history" aria-selected="false">Летальность</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="death-rate-history-tab" data-toggle="tab" href="#death-rate-history" role="tab" aria-controls="death-rate-history" aria-selected="false">Смертность</a>
  </li>
</ul>
<div class="tab-content">
  <div class="tab-pane active" id="latest" role="tabpanel" aria-labelledby="latest-tab">
    <div class="col-sm-4">
      <table class="table table-condensed table-striped" border="1">
        <tr>
          <th>Страна</th>
          <th align="right">Зараженных</th>
          <th>Выздоровлений</th>
          <th>Смертей</th>
          <th>Болеющих</th>
          <th>Летальность</th>
          <th>Смертность</th>
          <th>Прогноз</th>
        </tr>
        <thead>
        <tbody id="latestStat"></tbody>
      </table>
    </div>
  </div>
  <div class="tab-pane" id="confirmed-history" role="tabpanel" aria-labelledby="confirmed-history-tab">
    <table id = "confirmedHistory" class="table table-condensed table-striped table-hover"></table>
  </div> 
  <div class="tab-pane" id="recovered-history" role="tabpanel" aria-labelledby="recovered-history-tab">
    <table id = "recoveredHistory" class="table table-condensed table-striped table-hover"></table>
  </div> 
  <div class="tab-pane" id="death-history" role="tabpanel" aria-labelledby="death-history-tab">
    <table id = "deathHistory" class="table table-condensed table-striped table-hover"></table>
  </div> 
  <div class="tab-pane" id="active-history" role="tabpanel" aria-labelledby="active-history-tab">
    <table id = "activeHistory" class="table table-condensed table-striped table-hover"></table>
  </div>
  <div class="tab-pane" id="fatality-history" role="tabpanel" aria-labelledby="fatality-history-tab">
    <table id = "fatalityHistory" class="table table-condensed table-striped table-hover"></table>
  </div>
  <div class="tab-pane" id="death-rate-history" role="tabpanel" aria-labelledby="death-rate--history-tab">
    <table id = "deathRateHistory" class="table table-condensed table-striped table-hover"></table>
  </div>
</div>

<script language="javascript" src="vendor/jquery-3.4.1.min.js"></script>
<script language="javascript" src="vendor/popper.min.js"></script>
<script language="javascript" src="vendor/bootstrap/js/bootstrap.min.js"></script>
<script language="javascript" src="vendor/moment.js"></script>

<script language="javascript" src="config.js"></script>
<script language="javascript" src="timeseries.js"></script>
<script language="javascript" src="script.js"></script>
<script>
    var dates = convertData(data);
    var stat = countryStat(data, names);
    let dds = Object.keys(dates);
    dds.sort((a,b) => {
      if (a > b)
        return -1;
      if (a < b)
        return 1;
      return 0;
    });
    dds.forEach(d => {
      dates[d]["Total"] = totalStat(dates[d]);
    });
    let d0 = dds[0];
    document.getElementById("latestDate").innerHTML=moment.unix(d0).format("DD.MM.YYYY");
    stat["Total"] = dates[d0]["Total"];
    var countries = buildCountries(stat, threshold);

    outputBetterStatHtmlTable("latestStat", stat, countries);

    outputHistoryHtmlTable("confirmedHistory", dates, stat, countries, d => d.confirmed, d => d.confirmedDiff);
    outputHistoryHtmlTable("recoveredHistory", dates, stat, countries, d => d.recovered, d => d.recoveredDiff);
    outputHistoryHtmlTable("deathHistory", dates, stat, countries, d => d.deaths, d => d.deathsDiff);
    outputHistoryHtmlTable("activeHistory", dates, stat, countries, d => d.active, d => d.activeDiff);
    outputHistoryHtmlTable("fatalityHistory", dates, stat, countries, d => (100 * d.fatalityRate).toFixed(1), d => (100*d.fatalityRateDiff).toFixed(1));
    outputHistoryHtmlTable("deathRateHistory", dates, stat, countries, d => (100 * d.deathRate).toFixed(1), d => (100*d.deathRateDiff).toFixed(1));
</script>
<script id="latestStatTemplate" language="xTemplate">
</script>
</body>
</html>
